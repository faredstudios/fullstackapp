{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BidRedemptionTicket = exports.WINNER_INDEX_OFFSETS = void 0;\n\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\n\nconst bs58_1 = __importDefault(require(\"bs58\"));\n\nconst MetaplexProgram_1 = require(\"../MetaplexProgram\");\n\nconst mpl_core_1 = require(\"@metaplex-foundation/mpl-core\");\n\nexports.WINNER_INDEX_OFFSETS = [2, 10];\n\nclass BidRedemptionTicket extends mpl_core_1.Account {\n  constructor(pubkey, info) {\n    super(pubkey, info);\n\n    if (!this.assertOwner(MetaplexProgram_1.MetaplexProgram.PUBKEY)) {\n      throw (0, mpl_core_1.ERROR_INVALID_OWNER)();\n    }\n\n    if (BidRedemptionTicket.isBidRedemptionTicketV1(this.info.data)) {\n      throw (0, mpl_core_1.ERROR_DEPRECATED_ACCOUNT_DATA)();\n    } else if (BidRedemptionTicket.isBidRedemptionTicketV2(this.info.data)) {\n      const data = this.info.data.toJSON().data;\n      const winnerIndex = data[1] !== 0 && new bn_js_1.default(data.slice(1, 9), 'le');\n      const offset = exports.WINNER_INDEX_OFFSETS[+!!winnerIndex];\n      this.data = {\n        key: MetaplexProgram_1.MetaplexKey.BidRedemptionTicketV2,\n        winnerIndex,\n        data,\n        auctionManager: bs58_1.default.encode(data.slice(offset, offset + 32))\n      };\n    } else {\n      throw (0, mpl_core_1.ERROR_INVALID_ACCOUNT_DATA)();\n    }\n  }\n\n  static isCompatible(data) {\n    return BidRedemptionTicket.isBidRedemptionTicketV1(data) || BidRedemptionTicket.isBidRedemptionTicketV2(data);\n  }\n\n  static isBidRedemptionTicketV1(data) {\n    return data[0] === MetaplexProgram_1.MetaplexKey.BidRedemptionTicketV1;\n  }\n\n  static isBidRedemptionTicketV2(data) {\n    return data[0] === MetaplexProgram_1.MetaplexKey.BidRedemptionTicketV2;\n  }\n\n}\n\nexports.BidRedemptionTicket = BidRedemptionTicket;","map":{"version":3,"mappings":";;;;;;;;;;;;;AACA;;AACA;;AACA;;AACA;;AAiBaA,+BAAuB,CAAC,CAAD,EAAI,EAAJ,CAAvB;;AAEb,MAAaC,mBAAb,SAAyCC,kBAAzC,CAA2E;AACzEC,cAAYC,MAAZ,EAAkCC,IAAlC,EAA2D;AACzD,UAAMD,MAAN,EAAcC,IAAd;;AAEA,QAAI,CAAC,KAAKC,WAAL,CAAiBC,kCAAgBC,MAAjC,CAAL,EAA+C;AAC7C,YAAM,qCAAN;AACD;;AAED,QAAIP,mBAAmB,CAACQ,uBAApB,CAA4C,KAAKJ,IAAL,CAAUK,IAAtD,CAAJ,EAAiE;AAC/D,YAAM,+CAAN;AACD,KAFD,MAEO,IAAIT,mBAAmB,CAACU,uBAApB,CAA4C,KAAKN,IAAL,CAAUK,IAAtD,CAAJ,EAAiE;AACtE,YAAMA,IAAI,GAAG,KAAKL,IAAL,CAAUK,IAAV,CAAeE,MAAf,GAAwBF,IAArC;AAEA,YAAMG,WAAW,GAAGH,IAAI,CAAC,CAAD,CAAJ,KAAY,CAAZ,IAAiB,IAAII,eAAJ,CAAOJ,IAAI,CAACK,KAAL,CAAW,CAAX,EAAc,CAAd,CAAP,EAAyB,IAAzB,CAArC;AACA,YAAMC,MAAM,GAAGhB,6BAAqB,CAAC,CAAC,CAACa,WAAxB,CAAf;AAEA,WAAKH,IAAL,GAAY;AACVO,WAAG,EAAEV,8BAAYW,qBADP;AAEVL,mBAFU;AAGVH,YAHU;AAIVS,sBAAc,EAAEC,eAAKC,MAAL,CAAYX,IAAI,CAACK,KAAL,CAAWC,MAAX,EAAmBA,MAAM,GAAG,EAA5B,CAAZ;AAJN,OAAZ;AAMD,KAZM,MAYA;AACL,YAAM,4CAAN;AACD;AACF;;AAEkB,SAAZM,YAAY,CAACZ,IAAD,EAAa;AAC9B,WACET,mBAAmB,CAACQ,uBAApB,CAA4CC,IAA5C,KACAT,mBAAmB,CAACU,uBAApB,CAA4CD,IAA5C,CAFF;AAID;;AAE6B,SAAvBD,uBAAuB,CAACC,IAAD,EAAa;AACzC,WAAOA,IAAI,CAAC,CAAD,CAAJ,KAAYH,8BAAYgB,qBAA/B;AACD;;AAE6B,SAAvBZ,uBAAuB,CAACD,IAAD,EAAa;AACzC,WAAOA,IAAI,CAAC,CAAD,CAAJ,KAAYH,8BAAYW,qBAA/B;AACD;;AAxCwE;;AAA3ElB","names":["exports","BidRedemptionTicket","mpl_core_1","constructor","pubkey","info","assertOwner","MetaplexProgram_1","PUBKEY","isBidRedemptionTicketV1","data","isBidRedemptionTicketV2","toJSON","winnerIndex","bn_js_1","slice","offset","key","BidRedemptionTicketV2","auctionManager","bs58_1","encode","isCompatible","BidRedemptionTicketV1"],"sources":["../../../src/accounts/BidRedemptionTicket.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}